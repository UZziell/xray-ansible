# - name: create the dude
#   ansible.builtin.user:
#     name: thedude
#     shell: /bin/bash
#     groups: sudo
#     append: yes
#     password: "{{ dudepassword|password_hash('sha512') }}"

- name: Disable sshd 'PasswordAuthentication'
  ansible.builtin.lineinfile:
    path: /etc/ssh/sshd_config
    regexp: ^#?PasswordAuthentication
    line: PasswordAuthentication no
    validate: /usr/sbin/sshd -t -f %s
  notify:
    - Restart sshd service
